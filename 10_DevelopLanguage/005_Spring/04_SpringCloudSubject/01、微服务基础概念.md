###### 1. 什么是微服务？
**微服务**是一种云原生架构方法论，它将单个应用程序分解为**一组小型、松耦合的服务**，每个服务都在独立进程中运行，围绕特定业务能力构建，并通过轻量级机制（通常是HTTP RESTful API）进行通信。
从架构演进角度看，微服务是对**单体架构**和**SOA**的演进。与单体架构将所有功能打包在一个单元中不同，微服务强调彻底的组件化；与SOA相比，微服务的服务粒度更细，且去除了ESB的集中式总线概念。
**技术本质**：每个微服务拥有自己的技术栈和数据管理模型，通过API网关、服务发现等基础设施实现分布式系统治理。在Java生态中，这体现为Spring Cloud的`@EnableEurekaServer`服务注册、`@FeignClient`声明式服务调用等具体实现。
###### 2. 什么是微服务架构？它有哪些优缺点？
微服务架构是一种**将应用构建为小型服务集合的分布式系统设计风格**，每个服务可独立部署和扩展，通过轻量级通信协议协作。
1. 优点
- **技术多样性**：每个服务可选择最适合的技术栈，如订单服务用Java，报表服务用Python
- **独立部署**：单个服务修改只需重新部署该服务，不影响整体系统
- **精确扩展**：只需对瓶颈服务进行扩容，如"双11"时单独扩展库存服务
- **容错性**：服务故障被隔离，避免整个系统崩溃
- **团队自治**：小团队负责完整生命周期，提升开发效率
1. 缺点
- **分布式系统复杂性**：需要处理网络延迟、分布式事务等挑战
- **运维要求高**：需要管理大量服务实例，依赖容器化技术
- **数据一致性难**：跨服务数据同步需要最终一致性方案
- **接口变更成本**：服务接口修改可能影响多个消费者
- **测试复杂性**：需要模拟分布式环境进行集成测试
###### 3. 单体应用、SOA、微服务架构的区别是什么？

|**特征**​|**单体架构**​|**SOA**​|**微服务架构**​|
|---|---|---|---|
|**架构粒度**​|粗粒度，所有功能集中|中等粒度，服务按业务划分|细粒度，按业务能力分解|
|**数据管理**​|共享数据库|可能共享存储|每个服务独立数据库|
|**通信方式**​|进程内调用|ESB集中式总线|轻量级协议（REST/gRPC）|
|**部署方式**​|整体部署|服务可独立部署|完全独立部署|
|**技术栈**​|统一技术栈|技术栈相对统一|技术多样性支持|
|**治理重点**​|应用内治理|企业级标准化|去中心化治理|
SOA更关注企业服务复用和集成，而微服务聚焦应用解耦和快速交付。
###### 4. 微服务架构的核心特征有哪些？
- **组件化服务**：每个服务是可替换、可升级的独立单元
- **围绕业务能力**：按业务领域而非技术层次划分服务
- **产品而非项目**：团队对服务的全生命周期负责
- **智能端点与哑管道**：轻量级通信，业务逻辑在服务内处理
- **分散治理**：允许不同服务使用最适合的技术栈
- **分散数据管理**：每个服务有自己的数据存储
- **基础设施自动化**：依赖CI/CD和容器化技术
- **容错设计**：假设服务会故障，需有熔断机制
- **演进式设计**：服务可随业务需求被替换或重构
###### 5. 微服务的设计原则有哪些？
- **单一职责原则**：每个服务专注一个明确的业务领域
- **服务自治**：服务独立开发、测试、部署和扩展
- **轻量级通信**：采用REST、gRPC等跨语言协议
- **接口明确**：定义稳定、版本化的API契约
- **隔离性**：通过超时、熔断、降级避免级联故障
- **有界上下文**：基于DDD界定服务的业务边界
- **持续交付**：建立自动化部署流水线
- **可观测性**：集成日志、监控和追踪系统
###### 6. 什么是服务拆分？如何进行合理的服务拆分？
服务拆分是将单体应用按**业务边界**分解为多个微服务的过程。合理的拆分基于：
- **领域驱动设计**：按限界上下文划分，如电商分为订单、商品、用户等上下文
- **单一职责**：确保每个服务只负责一个业务能力，如支付服务只处理支付逻辑
- **松耦合高内聚**：服务间依赖最小化，服务内功能高度相关
- **团队结构**：参考康威定律，按团队边界划分服务
- **数据独立性**：每个服务拥有自己的数据源，避免共享数据库
拆分过程采用**绞杀者模式**，逐步从单体中剥离功能，而非一次性重写。
###### 7. 微服务架构中的领域驱动设计（DDD）是什么？
领域驱动设计是一种**通过领域模型指导复杂系统设计的方法论**，在微服务拆分中至关重要。
**核心概念**：
- **限界上下文**：定义领域模型的边界，是服务拆分的自然边界
- **实体与值对象**：实体有唯一标识，值对象描述特征
- **聚合根**：作为数据修改的入口点，维护业务一致性
- **领域事件**：表示领域中发生的重要事件，用于服务间通信
**实践应用**：在订单处理中，`Order`作为聚合根，包含`OrderItem`值对象，当订单状态变更时发布`OrderCreatedEvent`领域事件，库存服务监听该事件进行库存扣减。
###### 8. 微服务架构中如何处理数据一致性问题？
微服务采用**最终一致性**而非强一致性，具体方案：
- **Saga模式**：长事务分解为多个本地事务，如订单创建→库存扣减→支付，通过补偿事务回滚
- **事件溯源**：存储状态变化事件序列而非当前状态，通过重放事件重建状态
- **CQRS**：命令端处理写操作，查询端提供读模型，两者可不同步
- **TCC模式**：Try阶段预留资源，Confirm阶段确认操作，Cancel阶段释放资源
技术实现上，采用Apache Kafka作为事件存储，通过`KafkaTemplate`发布领域事件，确保至少一次投递语义。
###### 9. 什么是服务编排和服务编制？
- **服务编制**：通过中心化协调器控制流程，如通过工作流引擎定义订单流程
- **服务编排**：服务间通过事件或消息自主协作，如支付完成后发布事件触发后续服务
编制适合有明确流程控制的场景，编排更符合微服务去中心化理念。实际应用中，常采用**混合模式**：核心业务流程用编制确保一致性，辅助流程用编排提升灵活性。
###### 10. 微服务架构中的康威定律是什么？
康威定律指出"组织设计的系统结构会复制该组织的沟通结构"。在微服务中体现为：
- 团队结构决定架构：集中式团队易产生单体，分布式团队更适合微服务
- 团队自治要求服务自治：独立团队应拥有全功能服务的技术决策权
- 沟通成本影响服务边界：团队间沟通成本高的地方应是服务边界
实践中，按业务能力组建跨职能团队，如"用户团队"负责用户相关所有服务。
###### 11. 微服务的粒度如何把握？
微服务粒度是平衡艺术，考虑因素：
- **业务复杂度**：复杂领域可细粒度拆分，简单业务保持较粗粒度
- **团队规模**：小团队服务可稍大，大团队需更细拆分便于并行开发
- **性能要求**：高频调用的服务对可合并以减少网络开销
- **事务边界**：常一起修改的功能应放在同一服务
- **部署频率**：不同变更频率的功能应分离
**实用标准**：一个服务应由2-5人小团队维护，代码可在2小时内完全理解，API接口不超过10个。
###### 12. 微服务架构的演进路径是什么？
典型演进路径：
1. **单体阶段**：初期快速验证业务，所有功能集中开发
2. **垂直拆分**：按功能模块分离，如前端、后端分离
3. **服务化探索**：将稳定功能抽为服务，如用户服务
4. **领域驱动设计**：按业务领域深入拆分，建立限界上下文
5. **微服务成熟**：完善监控、治理等基础设施
演进过程中采用**绞杀者模式**，逐步替换单体功能而非推翻重来。
###### 13. 微服务架构适合什么样的业务场景？
- **高并发需求**：如电商平台需独立扩展核心服务
- **快速迭代**：多团队并行开发不同功能
- **复杂业务领域**：适合DDD指导的细分
- **多云部署需求**：不同服务可部署到不同环境
- **技术异构需求**：不同服务可采用最适合的技术栈
不适合场景：业务简单稳定、团队规模小、强事务要求高。
###### 14. 微服务架构的反模式有哪些？
- **分布式单体**：服务拆分了但仍高度耦合，需一起部署
- **过细粒度**：服务太小导致网络开销大于业务处理
- **共享数据库**：服务间通过数据库耦合，违背自治原则
- **硬编码依赖**：直接IP调用而非服务发现
- **忽略数据一致性**：缺乏分布式事务考虑
- **薄弱监控**：故障难以定位和排查
###### 15. 如何评估是否适合采用微服务架构？
评估维度：
- **业务因素**：业务复杂度高、需快速迭代适合微服务
- **技术能力**：团队需掌握分布式系统、容器化等技术
- **团队结构**：跨职能团队更适合微服务自治模式
- **运维能力**：需有CI/CD、监控等自动化运维体系
- **成本考量**：微服务初期基础设施成本较高
**迁移决策**：当单体应用难以维护、扩展性成为瓶颈，且团队具备相应能力时，才是迁移到微服务的合适时机。